## 镜像

　Docker的镜像类似虚拟机的快照，但更轻量，非常非常轻量（下节细说）。

　　创建Docker镜像有几种方式，多数是在一个现有镜像基础上创建新镜像，因为几乎你需要的任何东西都有了公共镜像，包括所有主流Linux发行版，你应该不会找不到你需要的镜像。不过，就算你想从头构建一个镜像，也有好几种方法。

　　要创建一个镜像，你可以拿一个镜像，对它进行修改来创建它的子镜像。实现前述目的的方式有两种：在一个文件中指定一个基础镜像及需要完成的修改；或通过“运行”一个镜像，对其进行修改并提交。不同方式各有优点，不过一般会使用文件来指定所做的变化。

　　镜像拥有唯一ID，以及一个供人阅读的名字和标签对。镜像可以命名为类似ubuntu:latest、ubuntu:precise、django:1.6、django:1.7等等。

##　容器

　　现在说容器了。你可以从镜像中创建容器，这等同于从快照中创建虚拟机，不过更轻量。应用是由容器运行的。

　　举个例子，你可以下载一个Ubuntu的镜像（有个叫docker registry的镜像公共仓库），通过安装Gunicorn和Django应用及其依赖项来完成对它的修改，然后从该镜像中创建一个容器，在它启动后运行你的应用。

![docker容器](http://wenku.baidu.com/content/d817967416fc700abb68fca1?m=53edf76e3be441c342485c83deb30a3d&type=pic&src=49049b6be22181041fcdbd54ce2b3341.png)

　　容器与虚拟机一样，是隔离的（有一点要注意，我稍后会讨论到）。它们也拥有一个唯一ID和唯一的供人阅读的名字。容器对外公开服务是必要的，因此Docker允许公开容器的特定端口。

![docker容器端口](http://wenku.baidu.com/content/d817967416fc700abb68fca1?m=53edf76e3be441c342485c83deb30a3d&type=pic&src=766c4dab3fb9cf4d1b93c27911a87fcd.png)

## 数据卷

　　数据卷让你可以不受容器生命周期影响进行数据持久化。它们表现为容器内的空间，但实际保存在容器之外，从而允许你在不影响数据的情况下销毁、重建、修改、丢弃容器。Docker允许你定义　**应用**　部分和　**数据**　部分，并提供工具让你可以将它们分开。使用Docker时必须做出的最大思维变化之一就是：**容器应该是短暂和一次性的。**

　　卷是针对容器的，你可以使用同一个镜像创建多个容器并定义不同的卷。卷保存在运行Docker的宿主文件系统上，你可以指定卷存放的目录，或让Docker保存在默认位置。保存在其他类型文件系统上的都不是一个卷，稍后再具体说。

![docker卷](http://wenku.baidu.com/content/d817967416fc700abb68fca1?m=53edf76e3be441c342485c83deb30a3d&type=pic&src=1a3e7e43842afc723bd6d25a318f4513.png)

　　卷还可以用来在容器间共享数据，建议你阅读卷的文档做进一步了解。

## 链接

　　链接是Docker的另一个重要部分。

　　容器启动时，将被分配一个随机的私有IP，其它容器可以使用这个IP地址与其进行通讯。这点非常重要，原因有二：一是它提供了容器间相互通信的渠道，二是进行通讯。这点非常重要，原因有二：一是它提供了容器间相互通信的渠道，二是容器将共享一个本地网络。我曾经碰到一个问题，在同一台机器上为两个客户启动两个elasticsearch容器，但保留集群名称为默认设置，结果这两台elasticsearch服务器立马变成了一个自主集群。注：限制容器间通讯是可行的，请阅读Docker的高级网络文档做进一步了解。

　　要开启容器间通讯，Docker允许你在创建一个新容器时引用其它现存容器，在你刚创建的容器里被引用的容器将获得一个（你指定的）别名。我们就说，这两个容器链接在了一起。

　　因此，如果DB容器已经在运行，我可以创建web服务器容器，并在创建时引用这个DB容器，给它一个别名，比如dbapp。在这个新建的web服务器容器里，我可以在任何时候使用主机名dbapp与DB容器进行通讯。

　　Docker更进一步，要求你声明容器在被链接时要开放哪些端口给其他容器，否则将没有端口可用。



创建镜像有很多方法，用户可以从 Docker Hub 获取已有镜像并更新，也可以利用本地文件系统创建一个。

### 修改已有镜像
